# Implementation Plan: Design System Tokens

**Branch**: `002-design-tokens` | **Date**: 2025-12-03 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/002-design-tokens/spec.md`

## Summary

Create a CSS-first semantic design tokens system with TypeScript exports for programmatic access. The tokens provide centralized, consistent values for colors, spacing, and typography across TaskFlow. A proof-of-concept migration of PriorityChart demonstrates the pattern.

## Technical Context

**Language/Version**: TypeScript 5.x, CSS3
**Primary Dependencies**: Tailwind CSS 4.x, Next.js 16, shadcn/ui
**Storage**: N/A (static configuration files)
**Testing**: Manual visual verification, TypeScript compilation check
**Target Platform**: Web browser (React/Next.js)
**Project Type**: Web application (frontend only for this feature)
**Performance Goals**: No runtime impact (static values)
**Constraints**: Must not break existing shadcn/ui styling
**Scale/Scope**: ~5 new files, 1 component migration, 1 doc update

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Status | Notes |
|-----------|--------|-------|
| I. Clean Architecture | ✅ N/A | Frontend-only feature, no backend changes |
| II. Type Safety | ✅ Pass | TypeScript tokens with proper types |
| III. Test-Driven Quality | ⚠️ Partial | Visual verification only (no unit tests for static values) |
| IV. Design System Consistency | ✅ Pass | Core purpose of this feature; docs will be updated |
| V. Simplicity & YAGNI | ✅ Pass | Minimal implementation, only tokens needed now |

**Gate Result**: PASS - No violations requiring justification.

## Project Structure

### Documentation (this feature)

```text
specs/002-design-tokens/
├── plan.md              # This file
├── research.md          # Token naming, structure decisions
├── data-model.md        # Token definitions and schemas
├── quickstart.md        # Developer usage guide
└── tasks.md             # Implementation tasks (generated by /tasks)
```

### Source Code (repository root)

```text
frontend/
├── app/
│   ├── globals.css      # Modified: add @import "./tokens.css"
│   └── tokens.css       # NEW: CSS custom properties
├── lib/
│   ├── tokens/
│   │   ├── index.ts     # NEW: Re-exports
│   │   ├── colors.ts    # NEW: Color token constants
│   │   ├── spacing.ts   # NEW: Spacing token constants
│   │   └── typography.ts # NEW: Typography token constants
│   ├── api.ts
│   └── utils.ts
├── components/
│   └── charts/
│       └── PriorityChart.tsx  # Modified: use tokens for colors

docs/
└── design-system.md     # Modified: add tokens section
```

**Structure Decision**: Frontend-only changes following existing `frontend/lib/` pattern for TypeScript modules. CSS tokens placed alongside globals.css for proximity.

## Implementation Phases

### Phase 1: CSS Token Foundation

Create the core CSS token definitions:

1. **Create `frontend/app/tokens.css`**
   - Define `:root` variables for light mode
   - Define `.dark` variables for dark mode
   - Include color, spacing, and typography tokens

2. **Update `frontend/app/globals.css`**
   - Add `@import "./tokens.css"` at the top
   - Ensure tokens are available before other styles

### Phase 2: TypeScript Token Exports

Create TypeScript modules for programmatic access:

1. **Create `frontend/lib/tokens/colors.ts`**
   - Export color object with semantic names
   - Include chart-specific color subset
   - Add JSDoc comments for IDE tooltips

2. **Create `frontend/lib/tokens/spacing.ts`**
   - Export spacing scale matching Tailwind
   - Use camelCase naming (space0_5, space1, etc.)

3. **Create `frontend/lib/tokens/typography.ts`**
   - Export fontSize, lineHeight, fontWeight objects
   - Match Tailwind's naming conventions

4. **Create `frontend/lib/tokens/index.ts`**
   - Re-export all token modules
   - Single import point for consumers

### Phase 3: Proof-of-Concept Migration

Migrate PriorityChart to demonstrate the pattern:

1. **Update `frontend/components/charts/PriorityChart.tsx`**
   - Import colors from `@/lib/tokens`
   - Replace `PRIORITY_COLORS` hardcoded values with token constants
   - Ensure visual output remains identical

### Phase 4: Documentation

Update design system documentation:

1. **Update `docs/design-system.md`**
   - Add "Design Tokens" section
   - Document when to use tokens vs. Tailwind
   - Include code examples
   - Reference quickstart guide

## File Changes Summary

| File | Action | Description |
|------|--------|-------------|
| `frontend/app/tokens.css` | Create | CSS custom properties for all tokens |
| `frontend/app/globals.css` | Modify | Add import for tokens.css |
| `frontend/lib/tokens/index.ts` | Create | Re-export all token modules |
| `frontend/lib/tokens/colors.ts` | Create | Color token constants |
| `frontend/lib/tokens/spacing.ts` | Create | Spacing token constants |
| `frontend/lib/tokens/typography.ts` | Create | Typography token constants |
| `frontend/components/charts/PriorityChart.tsx` | Modify | Use tokens for chart colors |
| `docs/design-system.md` | Modify | Add tokens documentation section |

## Verification Checklist

- [ ] CSS tokens visible in browser DevTools on `:root`
- [ ] Dark mode tokens apply when `.dark` class is active
- [ ] TypeScript imports resolve without errors
- [ ] IDE autocomplete shows all token options
- [ ] PriorityChart renders identically before/after migration
- [ ] Frontend builds without TypeScript errors
- [ ] Design system docs include tokens section

## Dependencies

**Blocked By**: None
**Blocks**: Future component migrations to tokens (optional)

## Risks & Mitigations

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| CSS variable name collision | Low | Medium | Using `--token-` prefix |
| Breaking existing styles | Low | High | Additive changes only, no modifications to shadcn variables |
| Token values mismatch | Medium | Low | Manual visual verification, side-by-side comparison |

## Complexity Tracking

> No constitution violations requiring justification.

| Item | Complexity | Notes |
|------|------------|-------|
| Total new files | 5 | All small, focused modules |
| Files modified | 3 | Minimal changes to existing code |
| Lines of code | ~200 | Mostly static value definitions |
